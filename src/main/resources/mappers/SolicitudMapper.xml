<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.eci.pdsw.samples.persistence.mybatisimpl.mappers.SolicitudMapper">
    
    
    <resultMap type='Solicitud' id='SolicitudResult'>
        <id property='fecha' column='fecha'/>
        <result property='cedula' column = 'Cedula_Numero'/>
        <result property = 'tipo_cedula' column = 'Cedula_Tipo' />
        <result property='tipo' column = 'tipo'/>
        <result property='estado' column = 'aprobado'/>
    </resultMap>
    
    
    
    <select id="consultarSolicitud" resultMap="SolicitudResult">
        select fecha , Cedula_Numero , Cedula_Tipo , tipo , aprobado
        from Solicitud 
        where aprobado='Pend'
        order by fecha
    </select>
    
    
    <resultMap type='Egresado' id='EgresadoResult'>
        <id property='cedula' column='Cedula_Numero'/>
        <result property='cedula_tipo' column = 'Cedula_Tipo'/>
        <result property = 'nombre' column = 'nombre' />
        <result property='fecha_grado' column = 'anio_grado'/>
        <result property='periodo_grado' column = 'periodo_grado'/>
        <result property='cargo' column = 'cargo'/>
        <result property='direccion_vivienda' column = 'direccion_vivienda'/>
        <result property='telefono_oficina' column = 'telefono_oficina'/>
        <result property='telefono_fijo' column = 'telefono_fijo'/>
        <result property='cedula' column = 'celular'/>
        <result property='programa' column = 'Programas_nombre'/>


    </resultMap>
    
     <resultMap type='Estudiante' id='EstudianteResult'>
        <id property='numero_identificacion' column='Cedula_Numero'/>
        <result property='tipo_identificacion' column = 'Cedula_Tipo'/>
        <result property = 'codigo' column = 'codigo_estudiante' />
        <result property='nombre' column = 'nombre'/>
        <result property='semestre' column = 'semestre_ponderado'/>
        <result property='telefono_fijo' column = 'telefono_fijo'/>
        <result property='celular' column = 'celular'/>
        <result property='direccion' column = 'direccion_vivienda'/>
        <result property='carrera' column = 'Programas_nombre'/>

    </resultMap>
    
    
    <select id="consultarEstudiante" resultMap="EstudianteResult">
        select Cedula_Numero,Cedula_Tipo,codigo_estudiante,nombre,semestre_ponderado,telefono_fijo,celular,direccion_vivienda,Programas_nombre
        from Datos_Estudiante 
        where Cedula_Numero=#{id} and Cedula_Tipo=#{idtipo}
    </select>
    
    
    <select id="consultarEgresado" resultMap="EgresadoResult">
        select Cedula_Numero,Cedula_Tipo,nombre,anio_grado,periodo_grado,cargo,direccion_vivienda,telefono_oficina,telefono_fijo,celular,Programas_nombre
        from Datos_Egresado
        where Cedula_Numero=#{id} and Cedula_Tipo=#{idtipo}
    </select>
    
    
    <insert parameterType="map" id="InsertarUsuario" >    
        insert into Usuario values(#{u.nombre},#{u.clave},#{u.tipo},#{u.estado},#{u.cedula_numero},#{u.cedula_tipo})
    </insert>
    <update  parameterType="map" id="ModificarSolicitud" >    
        UPDATE Solicitud
        SET aprobado = #{u}
        WHERE Cedula_Numero =10 and Cedula_Tipo="CE"  
    </update>
   
    <insert parameterType="map" id="insertarIdentificacion" >    
        insert into Identificacion values (#{id}, #{tipoid})
    </insert>
   
    <insert parameterType="map" id="insertarDatosEstudiante" >    
        insert into Datos_Estudiante values (#{est.numero_identificacion}, #{est.tipo_identificacion}, #{est.codigo}, #{est.nombre}, #{est.semestre},#{est.telefono_fijo}, #{est.celular}, #{est.direccion}, #{est.carrera})
    </insert>
   
    <insert parameterType="map" id="insertarSolicitud" >    
        insert into Solicitud values(#{sol.fecha}, #{sol.cedula}, #{sol.tipo_cedula}, #{sol.tipo}, #{sol.estado})
    </insert>
   
    <insert parameterType="map" id="insertarDatosEgresado" >                    
        insert into Datos_Egresado values(#{egr.cedula}, #{egr.cedula_tipo}, #{egr.nombre}, #{egr.fecha_grado}, #{egr.periodo_grado}, #{egr.cargo}, #{egr.direccion_vivienda},#{egr.nombreEmpresa},#{egr.direccionEmpresa},#{egr.telefono_oficina},#{egr.telefono_fijo},#{egr.celular},#{egr.programa} );
    </insert>
   
</mapper>